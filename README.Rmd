---
output:
  md_document:
    variant: gfm
---


```{r setup}
#devtools::install_github("thomazbastiaanssen/volatility")
library(tidyverse)
library(deleuze)
data = volatility::vola_genus_table$Validation_Pre_Control_2

b = log(sapply(data, FUN = function(x){sampleBetaBinom(samples = 1000, k = x, n = sum(data))}, simplify = T)) - sampleGeomMeam(samples = 1000, count_sample = data)

data

hist(sampleGeomMeam(samples = 10000, count_sample = data))

b %>%
  data.frame() %>%
  mutate(sample = as.character(1:1000)) %>%
  pivot_longer(!sample) %>%
 
  filter(name %in% paste0("X", 1:30)) %>%
  ggplot() +
  aes(x = value) +
 
  geom_histogram() +
  facet_wrap(~name, scales = "free") +
  theme_bw()

#Notice that the zero-count features such as X13 have a much higher spread than high rollers like X7
sampleCLR(1000, data) %>%
  data.frame() %>%
  mutate(sample = as.character(1:1000)) %>%
  pivot_longer(!sample) %>%
  
  filter(name %in% paste0("X", 1:30)) %>%
  ggplot() +
  aes(x = value) +
  
  geom_histogram() +
  facet_wrap(~name, scales = "free") +
  theme_bw()


```

